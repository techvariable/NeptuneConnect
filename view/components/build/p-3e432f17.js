import{b as t,I as e,g as r,i as n,T as s,c as u,d as o,e as l,D as f,m as a,s as i,N as c,a as h,f as d,P as k,l as m,h as y,k as p,n as w,o as A,p as M,q as v,E as g,r as C,t as E,u as D,v as I,w as b,x as V,y as B,z as L,A as R,B as S,C as U,F as H,G as P,H as j,J as x,K as q}from"./p-c7547485.js";function z(e,r){return t.create(e.ranges.map(r),e.mainIndex)}function F(t,e){return t.update({selection:e,scrollIntoView:true,userEvent:"select"})}function G({state:t,dispatch:e},r){let n=z(t.selection,r);if(n.eq(t.selection))return false;e(F(t,n));return true}function J(e,r){return t.cursor(r?e.to:e.from)}function K(t,e){return G(t,(r=>r.empty?t.moveByChar(r,e):J(r,e)))}const N=t=>K(t,t.textDirection!=f.LTR);const O=t=>K(t,t.textDirection==f.LTR);function T(t,e){return G(t,(r=>r.empty?t.moveByGroup(r,e):J(r,e)))}const Q=t=>T(t,t.textDirection!=f.LTR);const W=t=>T(t,t.textDirection==f.LTR);function X(t,e,r){if(e.type.prop(r))return true;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function Y(e,r,n){let s=i(e).resolveInner(r.head);let u=n?c.closedBy:c.openedBy;for(let t=r.head;;){let r=n?s.childAfter(t):s.childBefore(t);if(!r)break;if(X(e,r,u))s=r;else t=n?r.to:r.from}let o=s.type.prop(u),l,f;if(o&&(l=n?a(e,s.from,1):a(e,s.to,-1))&&l.matched)f=n?l.end.to:l.end.from;else f=n?s.to:s.from;return t.cursor(f,n?-1:1)}const Z=t=>G(t,(e=>Y(t.state,e,t.textDirection!=f.LTR)));const $=t=>G(t,(e=>Y(t.state,e,t.textDirection==f.LTR)));function _(t,e){return G(t,(r=>{if(!r.empty)return J(r,e);let n=t.moveVertically(r,e);return n.head!=r.head?n:t.moveToLineBoundary(r,e)}))}const tt=t=>_(t,false);const et=t=>_(t,true);function rt(t,e){let{state:r}=t,n=z(r.selection,(r=>r.empty?t.moveVertically(r,e,t.dom.clientHeight):J(r,e)));if(n.eq(r.selection))return false;let s=t.coordsAtPos(r.selection.main.head);let u=t.scrollDOM.getBoundingClientRect();t.dispatch(F(r,n),{effects:s&&s.top>u.top&&s.bottom<u.bottom?h.scrollIntoView(n.main.head,{y:"start",yMargin:s.top-u.top}):undefined});return true}const nt=t=>rt(t,false);const st=t=>rt(t,true);function ut(e,r,n){let s=e.lineBlockAt(r.head),u=e.moveToLineBoundary(r,n);if(u.head==r.head&&u.head!=(n?s.to:s.from))u=e.moveToLineBoundary(r,n,false);if(!n&&u.head==s.from&&s.length){let n=/^\s*/.exec(e.state.sliceDoc(s.from,Math.min(s.from+100,s.to)))[0].length;if(n&&r.head!=s.from+n)u=t.cursor(s.from+n)}return u}const ot=t=>G(t,(e=>ut(t,e,true)));const lt=t=>G(t,(e=>ut(t,e,false)));const ft=e=>G(e,(r=>t.cursor(e.lineBlockAt(r.head).from,1)));const at=e=>G(e,(r=>t.cursor(e.lineBlockAt(r.head).to,-1)));function it(e,r,n){let s=false,u=z(e.selection,(r=>{let u=a(e,r.head,-1)||a(e,r.head,1)||r.head>0&&a(e,r.head-1,1)||r.head<e.doc.length&&a(e,r.head+1,-1);if(!u||!u.end)return r;s=true;let o=u.start.from==r.head?u.end.to:u.end.from;return n?t.range(r.anchor,o):t.cursor(o)}));if(!s)return false;r(F(e,u));return true}const ct=({state:t,dispatch:e})=>it(t,e,false);function ht(e,r){let n=z(e.state.selection,(e=>{let n=r(e);return t.range(e.anchor,n.head,n.goalColumn)}));if(n.eq(e.state.selection))return false;e.dispatch(F(e.state,n));return true}function dt(t,e){return ht(t,(r=>t.moveByChar(r,e)))}const kt=t=>dt(t,t.textDirection!=f.LTR);const mt=t=>dt(t,t.textDirection==f.LTR);function yt(t,e){return ht(t,(r=>t.moveByGroup(r,e)))}const pt=t=>yt(t,t.textDirection!=f.LTR);const wt=t=>yt(t,t.textDirection==f.LTR);const At=t=>ht(t,(e=>Y(t.state,e,t.textDirection!=f.LTR)));const Mt=t=>ht(t,(e=>Y(t.state,e,t.textDirection==f.LTR)));function vt(t,e){return ht(t,(r=>t.moveVertically(r,e)))}const gt=t=>vt(t,false);const Ct=t=>vt(t,true);function Et(t,e){return ht(t,(r=>t.moveVertically(r,e,t.dom.clientHeight)))}const Dt=t=>Et(t,false);const It=t=>Et(t,true);const bt=t=>ht(t,(e=>ut(t,e,true)));const Vt=t=>ht(t,(e=>ut(t,e,false)));const Bt=e=>ht(e,(r=>t.cursor(e.lineBlockAt(r.head).from)));const Lt=e=>ht(e,(r=>t.cursor(e.lineBlockAt(r.head).to)));const Rt=({state:t,dispatch:e})=>{e(F(t,{anchor:0}));return true};const St=({state:t,dispatch:e})=>{e(F(t,{anchor:t.doc.length}));return true};const Ut=({state:t,dispatch:e})=>{e(F(t,{anchor:t.selection.main.anchor,head:0}));return true};const Ht=({state:t,dispatch:e})=>{e(F(t,{anchor:t.selection.main.anchor,head:t.doc.length}));return true};const Pt=({state:t,dispatch:e})=>{e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"}));return true};const jt=({state:e,dispatch:r})=>{let n=Zt(e).map((({from:r,to:n})=>t.range(r,Math.min(n+1,e.doc.length))));r(e.update({selection:t.create(n),userEvent:"select"}));return true};const xt=({state:e,dispatch:r})=>{let n=z(e.selection,(r=>{var n;let s=i(e).resolveInner(r.head,1);while(!(s.from<r.from&&s.to>=r.to||s.to>r.to&&s.from<=r.from||!((n=s.parent)===null||n===void 0?void 0:n.parent)))s=s.parent;return t.range(s.to,s.from)}));r(F(e,n));return true};const qt=({state:e,dispatch:r})=>{let n=e.selection,s=null;if(n.ranges.length>1)s=t.create([n.main]);else if(!n.main.empty)s=t.create([t.cursor(n.main.head)]);if(!s)return false;r(F(e,s));return true};function zt({state:e,dispatch:r},n){if(e.readOnly)return false;let s="delete.selection";let u=e.changeByRange((e=>{let{from:r,to:u}=e;if(r==u){let t=n(r);if(t<r)s="delete.backward";else if(t>r)s="delete.forward";r=Math.min(r,t);u=Math.max(u,t)}return r==u?{range:e}:{changes:{from:r,to:u},range:t.cursor(r)}}));if(u.changes.empty)return false;r(e.update(u,{scrollIntoView:true,userEvent:s}));return true}function Ft(t,e,r){if(t instanceof h)for(let n of t.pluginField(k.atomicRanges))n.between(e,e,((t,n)=>{if(t<e&&n>e)e=r?n:t}));return e}const Gt=(t,e)=>zt(t,(r=>{let{state:n}=t,s=n.doc.lineAt(r),u,f;if(!e&&r>s.from&&r<s.from+200&&!/[^ \t]/.test(u=s.text.slice(0,r-s.from))){if(u[u.length-1]=="\t")return r-1;let t=o(u,n.tabSize),e=t%l(n)||l(n);for(let t=0;t<e&&u[u.length-1-t]==" ";t++)r--;f=r}else{f=d(s.text,r-s.from,e,e)+s.from;if(f==r&&s.number!=(e?n.doc.lines:1))f+=e?1:-1}return Ft(t,f,e)}));const Jt=t=>Gt(t,false);const Kt=t=>Gt(t,true);const Nt=(t,e)=>zt(t,(r=>{let n=r,{state:s}=t,u=s.doc.lineAt(n);let o=s.charCategorizer(n);for(let t=null;;){if(n==(e?u.to:u.from)){if(n==r&&u.number!=(e?s.doc.lines:1))n+=e?1:-1;break}let l=d(u.text,n-u.from,e)+u.from;let f=u.text.slice(Math.min(n,l)-u.from,Math.max(n,l)-u.from);let a=o(f);if(t!=null&&a!=t)break;if(f!=" "||n!=r)t=a;n=l}return Ft(t,n,e)}));const Ot=t=>Nt(t,false);const Tt=t=>Nt(t,true);const Qt=t=>zt(t,(e=>{let r=t.lineBlockAt(e).to;return Ft(t,e<r?r:Math.min(t.state.doc.length,e+1),true)}));const Wt=t=>zt(t,(e=>{let r=t.lineBlockAt(e).from;return Ft(t,e>r?r:Math.max(0,e-1),false)}));const Xt=({state:e,dispatch:r})=>{if(e.readOnly)return false;let n=e.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:s.of(["",""])},range:t.cursor(e.from)})));r(e.update(n,{scrollIntoView:true,userEvent:"input"}));return true};const Yt=({state:e,dispatch:r})=>{if(e.readOnly)return false;let n=e.changeByRange((r=>{if(!r.empty||r.from==0||r.from==e.doc.length)return{range:r};let n=r.from,s=e.doc.lineAt(n);let u=n==s.from?n-1:d(s.text,n-s.from,false)+s.from;let o=n==s.to?n+1:d(s.text,n-s.from,true)+s.from;return{changes:{from:u,to:o,insert:e.doc.slice(n,o).append(e.doc.slice(u,n))},range:t.cursor(o)}}));if(n.changes.empty)return false;r(e.update(n,{scrollIntoView:true,userEvent:"move.character"}));return true};function Zt(t){let e=[],r=-1;for(let n of t.selection.ranges){let s=t.doc.lineAt(n.from),u=t.doc.lineAt(n.to);if(!n.empty&&n.to==u.from)u=t.doc.lineAt(n.to-1);if(r>=s.number){let t=e[e.length-1];t.to=u.to;t.ranges.push(n)}else{e.push({from:s.from,to:u.to,ranges:[n]})}r=u.number+1}return e}function $t(e,r,n){if(e.readOnly)return false;let s=[],u=[];for(let r of Zt(e)){if(n?r.to==e.doc.length:r.from==0)continue;let o=e.doc.lineAt(n?r.to+1:r.from-1);let l=o.length+1;if(n){s.push({from:r.to,to:o.to},{from:r.from,insert:o.text+e.lineBreak});for(let n of r.ranges)u.push(t.range(Math.min(e.doc.length,n.anchor+l),Math.min(e.doc.length,n.head+l)))}else{s.push({from:o.from,to:r.from},{from:r.to,insert:e.lineBreak+o.text});for(let e of r.ranges)u.push(t.range(e.anchor-l,e.head-l))}}if(!s.length)return false;r(e.update({changes:s,scrollIntoView:true,selection:t.create(u,e.selection.mainIndex),userEvent:"move.line"}));return true}const _t=({state:t,dispatch:e})=>$t(t,e,false);const te=({state:t,dispatch:e})=>$t(t,e,true);function ee(t,e,r){if(t.readOnly)return false;let n=[];for(let e of Zt(t)){if(r)n.push({from:e.from,insert:t.doc.slice(e.from,e.to)+t.lineBreak});else n.push({from:e.to,insert:t.lineBreak+t.doc.slice(e.from,e.to)})}e(t.update({changes:n,scrollIntoView:true,userEvent:"input.copyline"}));return true}const re=({state:t,dispatch:e})=>ee(t,e,false);const ne=({state:t,dispatch:e})=>ee(t,e,true);const se=t=>{if(t.state.readOnly)return false;let{state:e}=t,r=e.changes(Zt(e).map((({from:t,to:r})=>{if(t>0)t--;else if(r<e.doc.length)r++;return{from:t,to:r}})));let n=z(e.selection,(e=>t.moveVertically(e,true))).map(r);t.dispatch({changes:r,selection:n,scrollIntoView:true,userEvent:"delete.line"});return true};function ue(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let r=i(t).resolveInner(e);let n=r.childBefore(e),s=r.childAfter(e),u;if(n&&s&&n.to<=e&&s.from>=e&&(u=n.type.prop(c.closedBy))&&u.indexOf(s.name)>-1&&t.doc.lineAt(n.to).from==t.doc.lineAt(s.from).from)return{from:n.to,to:s.from};return null}const oe=fe(false);const le=fe(true);function fe(u){return({state:o,dispatch:l})=>{if(o.readOnly)return false;let f=o.changeByRange((l=>{let{from:f,to:a}=l,i=o.doc.lineAt(f);let c=!u&&f==a&&ue(o,f);if(u)f=a=(a<=i.to?i:o.doc.lineAt(a)).to;let h=new e(o,{simulateBreak:f,simulateDoubleBreak:!!c});let d=r(h,f);if(d==null)d=/^\s*/.exec(o.doc.lineAt(f).text)[0].length;while(a<i.to&&/\s/.test(i.text[a-i.from]))a++;if(c)({from:f,to:a}=c);else if(f>i.from&&f<i.from+100&&!/\S/.test(i.text.slice(0,f)))f=i.from;let k=["",n(o,d)];if(c)k.push(n(o,h.lineIndent(i.from,-1)));return{changes:{from:f,to:a,insert:s.of(k)},range:t.cursor(f+1+k[1].length)}}));l(o.update(f,{scrollIntoView:true,userEvent:"input"}));return true}}function ae(e,r){let n=-1;return e.changeByRange((s=>{let u=[];for(let t=s.from;t<=s.to;){let o=e.doc.lineAt(t);if(o.number>n&&(s.empty||s.to>o.from)){r(o,u,s);n=o.number}t=o.to+1}let o=e.changes(u);return{changes:u,range:t.range(o.mapPos(s.anchor,1),o.mapPos(s.head,1))}}))}const ie=({state:t,dispatch:s})=>{if(t.readOnly)return false;let u=Object.create(null);let o=new e(t,{overrideIndentation:t=>{let e=u[t];return e==null?-1:e}});let l=ae(t,((e,s,l)=>{let f=r(o,e.from);if(f==null)return;if(!/\S/.test(e.text))f=0;let a=/^\s*/.exec(e.text)[0];let i=n(t,f);if(a!=i||l.from<e.from+a.length){u[e.from]=f;s.push({from:e.from,to:e.from+a.length,insert:i})}}));if(!l.changes.empty)s(t.update(l,{userEvent:"indent"}));return true};const ce=({state:t,dispatch:e})=>{if(t.readOnly)return false;e(t.update(ae(t,((e,r)=>{r.push({from:e.from,insert:t.facet(u)})})),{userEvent:"input.indent"}));return true};const he=({state:t,dispatch:e})=>{if(t.readOnly)return false;e(t.update(ae(t,((e,r)=>{let s=/^\s*/.exec(e.text)[0];if(!s)return;let u=o(s,t.tabSize),f=0;let a=n(t,Math.max(0,u-l(t)));while(f<s.length&&f<a.length&&s.charCodeAt(f)==a.charCodeAt(f))f++;r.push({from:e.from+f,to:e.from+s.length,insert:a.slice(f)})})),{userEvent:"delete.dedent"}));return true};const de=[{key:"Ctrl-b",run:N,shift:kt,preventDefault:true},{key:"Ctrl-f",run:O,shift:mt},{key:"Ctrl-p",run:tt,shift:gt},{key:"Ctrl-n",run:et,shift:Ct},{key:"Ctrl-a",run:ft,shift:Bt},{key:"Ctrl-e",run:at,shift:Lt},{key:"Ctrl-d",run:Kt},{key:"Ctrl-h",run:Jt},{key:"Ctrl-k",run:Qt},{key:"Ctrl-Alt-h",run:Ot},{key:"Ctrl-o",run:Xt},{key:"Ctrl-t",run:Yt},{key:"Ctrl-v",run:st}];const ke=[{key:"ArrowLeft",run:N,shift:kt,preventDefault:true},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Q,shift:pt},{mac:"Cmd-ArrowLeft",run:lt,shift:Vt},{key:"ArrowRight",run:O,shift:mt,preventDefault:true},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:W,shift:wt},{mac:"Cmd-ArrowRight",run:ot,shift:bt},{key:"ArrowUp",run:tt,shift:gt,preventDefault:true},{mac:"Cmd-ArrowUp",run:Rt,shift:Ut},{mac:"Ctrl-ArrowUp",run:nt,shift:Dt},{key:"ArrowDown",run:et,shift:Ct,preventDefault:true},{mac:"Cmd-ArrowDown",run:St,shift:Ht},{mac:"Ctrl-ArrowDown",run:st,shift:It},{key:"PageUp",run:nt,shift:Dt},{key:"PageDown",run:st,shift:It},{key:"Home",run:lt,shift:Vt},{key:"Mod-Home",run:Rt,shift:Ut},{key:"End",run:ot,shift:bt},{key:"Mod-End",run:St,shift:Ht},{key:"Enter",run:oe},{key:"Mod-a",run:Pt},{key:"Backspace",run:Jt,shift:Jt},{key:"Delete",run:Kt},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Ot},{key:"Mod-Delete",mac:"Alt-Delete",run:Tt},{mac:"Mod-Backspace",run:Wt},{mac:"Mod-Delete",run:Qt}].concat(de.map((t=>({mac:t.key,run:t.run,shift:t.shift}))));const me=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Z,shift:At},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:$,shift:Mt},{key:"Alt-ArrowUp",run:_t},{key:"Shift-Alt-ArrowUp",run:re},{key:"Alt-ArrowDown",run:te},{key:"Shift-Alt-ArrowDown",run:ne},{key:"Escape",run:qt},{key:"Mod-Enter",run:le},{key:"Alt-l",mac:"Ctrl-l",run:jt},{key:"Mod-i",run:xt,preventDefault:true},{key:"Mod-[",run:he},{key:"Mod-]",run:ce},{key:"Mod-Alt-\\",run:ie},{key:"Shift-Mod-k",run:se},{key:"Shift-Mod-\\",run:ct}].concat(ke);const ye=[m(),y(),p(),w(),A(),M(),v(),g.allowMultipleSelections.of(true),C(),E.fallback,D(),I(),b(),V(),B(),L(),R.of([...S,...me,...U,...H,...P,...j,...x,...q])];export{ye as b};
//# sourceMappingURL=p-3e432f17.js.map